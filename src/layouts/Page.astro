---
const { title = 'Smart Irrigation Tolima' } = Astro.props;
const site = new URL(Astro.site);
const basePath = site.pathname.endsWith('/') ? site.pathname : site.pathname + '/';

function withBase(path = '') {
	const normalized = path.startsWith('/') ? path.slice(1) : path;
	return basePath + normalized;
}

const navItems = [
	{ label: 'Inicio', path: '', exact: true },
	{ label: 'Justificación', path: 'justificacion' },
	{ label: 'Problema', path: 'problema' },
	{ label: 'Objetivos', path: 'objetivos' },
	{ label: 'Marco teórico', path: 'marco-teorico' },
	{ label: 'Metodología', path: 'metodologia' },
	{ label: 'Resultados', path: 'resultados-esperados' },
	{ label: 'Referencias', path: 'referencias' }
];

const currentPath = Astro.url.pathname.replace(basePath, '/');

function hrefFor(path = '') {
	return withBase(path);
}

function activeClass(path = '', exact = false) {
	const target = path ? `/${path}` : '/';
	const isActive = exact ? currentPath === target : currentPath.startsWith(target);
	return isActive ? 'active' : '';
}

const favicon = withBase('favicon.svg');
---
<html lang="es">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href={favicon} />
		<meta name="viewport" content="width=device-width" />
		<title>{title}</title>
		<style>
			:root{color-scheme:light dark; --bg1:#f0f9f4; --text:#0f1b14; --card:#ffffff; --muted:#5f6368; --brand:#2e7d32; --brand2:#43a047; --border:#d7e2d7}
			body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:linear-gradient(180deg,var(--bg1) 0%,#f8fff9 100%);color:var(--text)}
			header{padding:1.1rem;border-bottom:1px solid var(--border);background:linear-gradient(115deg,#e8f5e9 0%,#f1f8e9 60%,#e0f2f1 100%);position:sticky;top:0;z-index:10;backdrop-filter:saturate(120%) blur(6px)}
			footer{padding:1rem;border-top:1px solid var(--border);background:#ffffffd9}
			nav a{color:inherit;text-decoration:none;margin-right:0.5rem;padding:0.45rem 0.75rem;border-radius:12px;transition:all .18s ease;font-weight:500}
			nav a:hover{background:#dff1e0;box-shadow:0 2px 8px rgba(67,160,71,.18);transform:translateY(-1px)}
			nav a.active{background:linear-gradient(100deg,var(--brand),var(--brand2));color:#fff;box-shadow:0 3px 14px rgba(46,125,50,.28)}
			.container{max-width:1100px;margin:0 auto;padding:0 0.5rem}
			main{padding:2rem 1.5rem;background:#fffffff2;border:1px solid #e5efe6;border-radius:22px;box-shadow:0 14px 30px rgba(19,32,20,.08);margin:1.5rem auto 2.5rem auto}
			h1,h2,h3{color:#15451f}
			.card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:1.1rem;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
			.btn{padding:0.65rem 1.1rem;border-radius:14px;border:1px solid var(--brand);background:linear-gradient(90deg,var(--brand),var(--brand2));color:#fff;text-decoration:none;box-shadow:0 6px 16px rgba(46,125,50,0.28);transition:transform .12s ease,box-shadow .12s}
			.btn:hover{transform:translateY(-2px);box-shadow:0 8px 18px rgba(46,125,50,0.32)}
			.btn--ghost{border:1px solid var(--border);background:#fff;color:var(--text);box-shadow:0 4px 12px rgba(0,0,0,.05)}
		</style>
	</head>
	<body>
		<header>
			<div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:0.5rem;flex-wrap:wrap;">
				<strong>OPTIMIZACIÓN DE RIEGO</strong>
				<nav>
					{navItems.map((item) => (
						<a href={hrefFor(item.path)} class={activeClass(item.path, item.exact)}>{item.label}</a>
					))}
				</nav>
			</div>
		</header>
		<main class="container">
			<slot />
		</main>
		<footer>
			<div class="container" style="display:flex;justify-content:space-between;gap:1rem;flex-wrap:wrap;">
				<span>© 2025 Universidad del Tolima</span>
				<a href="https://github.com/lizethcarosilva/optimizaci-n_riego_agricultura.github.io" target="_blank" rel="noopener">Código en GitHub</a>
			</div>
		</footer>
	</body>
</html>
