---
const { title = 'Smart Irrigation Tolima' } = Astro.props;
const site = new URL(Astro.site);
const basePath = site.pathname.endsWith('/') ? site.pathname : site.pathname + '/';

function withBase(path = '') {
	const normalized = path.startsWith('/') ? path.slice(1) : path;
	return basePath + normalized;
}

const navItems = [
	{ label: 'Inicio', path: '', exact: true },
	{ label: 'Justificación', path: 'justificacion' },
	{ label: 'Problema', path: 'problema' },
	{ label: 'Objetivos', path: 'objetivos' },
	{ label: 'Marco teórico', path: 'marco-teorico' },
	{ label: 'Metodología', path: 'metodologia' },
	{ label: 'Resultados', path: 'resultados-esperados' },
	{ label: 'Referencias', path: 'referencias' }
];

const currentPath = Astro.url.pathname.replace(basePath, '/');

function hrefFor(path = '') {
	return withBase(path);
}

function activeClass(path = '', exact = false) {
	const target = path ? `/${path}` : '/';
	const isActive = exact ? currentPath === target : currentPath.startsWith(target);
	return isActive ? 'active' : '';
}

const favicon = withBase('favicon.svg');
---
<html lang="es" class="h-full">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href={favicon} />
		<meta name="viewport" content="width=device-width" />
		<title>{title}</title>
		<style>
			:root{color-scheme:light dark}
		</style>
	</head>
	<body class="min-h-full bg-gradient-to-b from-emerald-50 to-white text-neutral-900">
		<header class="sticky top-0 z-10 border-b border-emerald-100 bg-gradient-to-r from-emerald-50 via-emerald-100 to-teal-50/80 backdrop-blur">
			<div class="max-w-[1100px] mx-auto px-2 py-3 flex items-center justify-between gap-2 flex-wrap">
				<strong class="text-emerald-900 tracking-wide">OPTIMIZACIÓN DE RIEGO</strong>
				<nav class="flex items-center gap-2">
					{navItems.map((item) => (
						<a href={hrefFor(item.path)} class={`px-3 py-2 rounded-xl transition shadow-sm hover:-translate-y-0.5 hover:shadow ${activeClass(item.path, item.exact) ? 'bg-gradient-to-r from-emerald-600 to-teal-600 text-white' : 'bg-white/70 text-emerald-900 hover:bg-emerald-50 border border-emerald-100'}`}>{item.label}</a>
					))}
				</nav>
			</div>
		</header>
		<main class="max-w-[1100px] mx-auto px-2 py-6">
			<slot />
		</main>
		<footer class="border-t border-emerald-100 bg-white/90">
			<div class="max-w-[1100px] mx-auto px-2 py-4 flex items-center justify-between gap-3 flex-wrap">
				<span class="text-sm text-neutral-600">© 2025 Universidad del Tolima</span>
				<a class="text-sm text-emerald-800 hover:underline" href="https://github.com/lizethcarosilva/optimizaci-n_riego_agricultura.github.io" target="_blank" rel="noopener">Código en GitHub</a>
			</div>
		</footer>
	</body>
</html>
